<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Introduction</h1>

<p><a href="https://www.d4ta.link/">D4TAlink</a> is a collection of tools, methods and processes for the management 
of analysis workflows. These lightweight solutions facilitate the 
structuring of R&amp;D activities in compliance with FAIR and ALCOA principles. </p>

<p><a href="https://bitbucket.org/SQ4/d4talink.light/">D4TAlink.light</a> is an <a href="https://www.r-project.org/">R</a> packages with core functions to implement D4TAlink&#39;s processes. </p>

<ol>
<li>FAIR principles: Jacobsen et al., 2017 (<a href="https://doi.org/10.1162/dint_r_00024">doi:10.1162/dint_r_00024</a>)</li>
<li>ALCOA principles: Food &amp; Drug Administration, 2018 (<a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/data-integrity-and-compliance-drug-cgmp-questions-and-answers-guidance-industry">Data Integrity and Compliance With Drug CGMP - Questions and Answers Guidance for Industry</a>).</li>
</ol>

<h1>Installation</h1>

<p>Install from <a href="https://CRAN.R-project.org/package=D4TAlink.light">CRAN</a>: </p>

<pre><code class="r">install.packages(&quot;D4TAlink.light&quot;)
</code></pre>

<p>Install latest version from <a href="https://bitbucket.org/SQ4/d4talink.light">Bitbucket</a>:</p>

<pre><code class="r">devtools::install_bitbucket(&quot;SQ4/d4talink.light&quot;,subdir=&quot;D4TAlink.light&quot;)
</code></pre>

<p>Note that you may need to install: </p>

<ul>
<li>the Bioconductor package <code>Biobase</code>  (<a href="https://bioconductor.org/install/">instructions</a>), and</li>
<li>Rtools (<a href="https://cran.r-project.org/bin/windows/">cran.r-project.org/bin/windows</a>).</li>
</ul>

<h1>Tutorial</h1>

<h2>Setting base parameters</h2>

<p>Once the R package loaded, user must set D4TAlink&#39;s global parameters, namely 
the name of the data analyst and the name of the study sponsor.</p>

<pre><code class="r">library(D4TAlink.light)

setTaskAuthor(&quot;Doe Johns&quot;)
setTaskSponsor(&quot;mySponsor&quot;)
</code></pre>

<p>The location of the data file repository, must then be defined. Indeed, D4TAlink 
manages data and information in flat files within a structured directory tree. </p>

<pre><code class="r">setTaskRoot(file.path(tempdir(),&quot;D4TAlink_example001&quot;),dirCreate=TRUE)
</code></pre>

<p>As described below, other parameters can be defined.</p>

<pre><code class="r">setTaskRmdTemplate(&quot;/SOME/WHERE/my.Rmd&quot;)
setTaskStructure(pathsDefault)
</code></pre>

<p>Note that D4TAlink&#39;s parameters can be set via the <a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html#Invoking-R"><code>.Renviron</code></a> 
file located in the system home directory.</p>

<pre><code>D4TAlink_author=&quot;Dow Johns&quot;
D4TAlink_sponsor=&quot;CompanyA&quot;
D4TAlink_root=&quot;/SOME/WHERE/D4TAlink_example001&quot;
D4TAlink_rmdtempl=&quot;/SOME/WHERE/my.Rmd&quot;
D4TAlink_rscripttempl=&quot;/SOME/WHERE/my.R&quot;
D4TAlink_pathgen=&quot;pathsDefault&quot;
</code></pre>

<h2>Creating an analysis task</h2>

<p>A data analysis workflow typically comprises a succession of distinct analyses task. 
A typical analysis workflow would comprise the following tasks:</p>

<ol>
<li>exporting and loading of source data, </li>
<li>data transformation (e.g., normalization and imputation), </li>
<li>descriptive statistics, and </li>
<li>statistical modelling. </li>
</ol>

<p>Coding these successive tasks using a single analysis script is a bad practice for 
multiple reasons. Firstly, the analysis scripts become lengthy and thus difficult 
to write, review and maintain. Further, this prevents code reuse and hinders 
project agility. Finally, this complexifies team collaboration on a single workflow. </p>

<p>D4TAlink define the &#39;analysis task&#39; as a central concept. A data analysis workflow 
consisting of a succession of tasks that could be arborescent. </p>

<p>Each task is assigned to a <strong>work package</strong>, which is assigned to a <strong>project</strong>, and
each project is assigned to a <strong>sponsor</strong>. </p>

<p>To create an analysis task in R use the following calls.</p>

<pre><code class="r"># make sure that the sopnsor was defined
setTaskSponsor(&quot;mySponsor&quot;)

# create a task
task &lt;- initTask(project=&quot;myProject&quot;,
                 package=&quot;myPackage&quot;,
                 taskname=sprintf(&quot;%s_myTask&quot;,format(Sys.time(),&quot;%Y%m%d&quot;)))
</code></pre>

<h2>Accessing content of a task</h2>

<p>Each task has it&#39;s own directory structure. The task contains storage for five types of 
data: </p>

<ol>
<li><strong>output data</strong>: typically, the data produced by the script in for of excel files, graphic files, &hellip;, </li>
<li><strong>source data</strong>: local storage for the input data provided by third parties, </li>
<li><strong>analysis scripts</strong>: data analysis scripts in R, SAS, python, &hellip;, </li>
<li><strong>documentation</strong>: documentation of the analysis task, </li>
<li><strong>binary data</strong>: output data for the task stored in binary format for follow-up task. </li>
</ol>

<p>The location of these data can be obtained using respectively the functions <code>reportDir</code>, 
<code>datasourceDir</code>, <code>progDir</code>, <code>docDir</code>, and <code>binaryDir</code>.   </p>

<p>For traceability, the files within a task have specifically the format <code>[TASK_NAME]_[DATA_TYPE].[EXTENSTION]</code>, where <code>DATA_TYPE</code> is a short string 
describing the content of the file, and <code>EXTENSION</code> the file tyle (e.g., <code>pdf</code> or 
<code>xlsx</code>). By convention <code>TASK_NAME</code> has a date as prefix with format <code>%Y%m%d_</code>, 
and <code>DATA_TYPE</code> does not contain underscores or dots, <code>_</code> or <code>.</code>.</p>

<p>The function <code>listTaskFiles</code> returns a list of files associated with a task: </p>

<pre><code class="r">listTaskFiles(task)
</code></pre>

<p>Similarly, the function <code>listTasks</code> returns a list of all tasks in the repository: </p>

<pre><code class="r">listTasks()
</code></pre>

<h2>Reporting graphics in a task</h2>

<p>To output a graphic file in the output directory of the task, use the following.</p>

<p><strong>PDF</strong></p>

<pre><code class="r">file &lt;- pdfReport(task,c(&quot;plots&quot;,1),dim=c(100,100))
hist(rnorm(100))
dev.off()
openPDF(file)
</code></pre>

<p><strong>PNG</strong></p>

<pre><code class="r">file &lt;- pngReport(task,c(&quot;plots&quot;,1),dim=c(300,300))
hist(rnorm(100))
dev.off()
print(file)
</code></pre>

<p><strong>JPEG</strong></p>

<pre><code class="r">file &lt;- jpegReport(task,c(&quot;plots&quot;,1),dim=c(300,300))
hist(rnorm(100))
dev.off()
print(file)
</code></pre>

<h2>Reporting tables in a task</h2>

<p>To output data frames as an Excel file in the output directory of the task, use the following:</p>

<pre><code class="r">d &lt;- list(letters=data.frame(a=LETTERS,b=letters,c=1:length(letters)),
          other=data.frame(a=1:3,b=11:13))
file &lt;- saveReportXls(d,task,&quot;tables&quot;)
print(file)
</code></pre>

<p>and to output in a text file:</p>

<pre><code class="r">file &lt;- saveReportTable(d$letters,task,&quot;tables&quot;)
print(file)
</code></pre>

<h2>Transfering data from a task to another</h2>

<p>Tasks each constituting an element in a stepwise process, data can be transferred 
from a task to the other. To do so, R objects must be stored by the parent task 
using the call <code>saveBinary(object,task,&quot;ojectType&quot;)</code>. The child task may then load the data 
from the parent task using the call <code>saveBinary(loadTask(...),&quot;ojectType&quot;)</code>. Here 
is an example. </p>

<p>Saving data in a parent task:</p>

<pre><code class="r">d &lt;- list(letters=data.frame(a=LETTERS,b=letters,c=1:length(letters)),
          other=data.frame(a=1:3,b=11:13))
task &lt;- initTask(project=&quot;myProject&quot;,
                 package=&quot;myPackage&quot;,
                 taskname=&quot;20220801_parentTask&quot;)
file &lt;- saveBinary(d,task,&quot;someData&quot;)
print(file)
</code></pre>

<p>Loading data in a child task: </p>

<pre><code class="r">task &lt;- initTask(project=&quot;myProject&quot;,
                 package=&quot;myPackage&quot;,
                 taskname=&quot;20220801_childTask&quot;)
e &lt;- readBinary(loadTask(task$project,task$package,&quot;20220801_parentTask&quot;),&quot;someData&quot;)
</code></pre>

<h2>Create and render task documentation</h2>

<p>Documentation of a task is typically authored using 
<a href="https://rmarkdown.rstudio.com/">R markdown</a> files (Rmd). D4TAlink advises to have one 
Rmd file per task. <code>D4TAlink.light</code> provides functions to create and render these files. </p>

<p>Creation of an R markdown file from template:</p>

<pre><code class="r">file &lt;- initTaskRmd(task)
print(file)
</code></pre>

<p>Rendering of the markdown file into the task documentation directory:</p>

<pre><code class="r">file &lt;- renderTaskRmd(task) # may require having run &#39;tinytex::install_tinytex()&#39;
openPDF(file)
</code></pre>

<h2>Create a task R script</h2>

<p>For some task an R script may also be needed. The task script can be created from the default template: </p>

<pre><code class="r">file &lt;- initTaskRscript(task)
print(file)
</code></pre>

<h2>Task archiving</h2>

<p>D4TAlink has tools to archive and restore tasks. This enables, for instance, transferring tasks
from one repository to another. </p>

<p>Archiving a task: </p>

<pre><code class="r">setTaskRoot(file.path(tempdir(),&quot;D4TAlink_exampleFrom&quot;),dirCreate=TRUE)
task &lt;- initTask(project=&quot;myProject&quot;,
                 package=&quot;myPackage&quot;,
                 taskname=&quot;20220501_myTask&quot;)
file &lt;- tempfile(fileext=&quot;.zip&quot;)
archiveTask(task,file)
print(reportDir(task))
</code></pre>

<p>Restore a task to a different archive:</p>

<pre><code class="r">setTaskRoot(file.path(tempdir(),&quot;D4TAlink_exampleTo&quot;),dirCreate=TRUE)
restoreTask(file)
newtask &lt;- loadTask(project=&quot;myProject&quot;,
                    package=&quot;myPackage&quot;,
                    taskname=&quot;20220501_myTask&quot;)
print(reportDir(newtask))
</code></pre>

<h2>Changing R markdown and script templates</h2>

<p>The R markdown and script templates can be set using the functions <code>setTaskRmdTemplate</code> and <code>setTaskRscriptTemplate</code> as follows.  </p>

<pre><code class="r">setTaskRmdTemplate(&quot;/SOME/WHERE/my.Rmd&quot;)
setTaskRscriptTemplate(&quot;/SOME/WHERE/my.R&quot;)
</code></pre>

<p>The available path generation functions are <code>pathsDefault</code>, <code>pathsGLPG</code>, and <code>pathsPMS</code>.</p>

<p>Further, the path path th the template can be set in the <a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html#Invoking-R"><code>.Renviron</code></a> file:</p>

<pre><code>D4TAlink_rmdtempl=&quot;/SOME/WHERE/my.Rmd&quot;
D4TAlink_rscripttempl=&quot;/SOME/WHERE/my.R&quot;
</code></pre>

<h2>Changing directory structure</h2>

<p>The directory structure can be customized, by creating a directory using the command <code>setTaskStructure</code> as follows.  </p>

<pre><code class="r">fun &lt;- function(project,package,taskname,sponsor) {
  basePath &lt;- file.path(&quot;%ROOT%&quot;,sponsor,project,package)
  paths &lt;- list(
    root = &quot;%ROOT%&quot;,
    datasrc = file.path(basePath, &quot;raw&quot;, &quot;data_source&quot;),
    data = file.path(basePath, &quot;output&quot;,&quot;adhoc&quot;,taskname),
    bin  = file.path(basePath, &quot;output&quot;,&quot;adhoc&quot;,taskname,&quot;bin&quot;),
    code = file.path(basePath, &quot;progs&quot;),
    doc  = file.path(basePath, &quot;docs&quot;),
    log  = file.path(basePath, &quot;output&quot;,&quot;log&quot;)
  )
}

setTaskStructure(fun)
</code></pre>

<p>The available path generation functions are <code>pathsDefault</code>, <code>pathsGLPG</code>, and <code>pathsPMS</code>.</p>

<p>Further, the path generator can be set in the <a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html#Invoking-R"><code>.Renviron</code></a> file, the available functions being &#39;pathsDefault&#39;, &#39;pathsGLPG&#39;, and &#39;pathsPMS&#39;:</p>

<pre><code>D4TAlink_pathgen=&quot;pathsDefault&quot;
</code></pre>

</body>

</html>
